
<!-- saved from url=(0038)https://tools-qa.mellanox.com/driveto/ -->
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script type="text/javascript" src="Drive To_files/custom.js"></script>
<script>
	var geo_sites = new Array();
	var nv_apps = new Array();
	
	var detected = 0;
	var nv_selected = 1 ;
	
	
	
	var nv_lat = 0;
	var nv_lon = 0;
	
	var isNavButtonClicked = false;
	
	//var MX = new Array(3).fill(new Array(3).fill(null))
	

	
	var cities = [ [0 , 0 , 0 , 0], ['Yokneam - MTL' , 0 , "flag_israel.png" , 0] , ['Beer Sheva - MTBG' , 0 , "flag_israel.png" , 0],  ['Boston - MTB' , 0 , 0 , 0 ] , ['Texas - MTI' , 0 , 0, 0   ] ,  ['California - MTSP' , 0 , 0 , 0  ] , ['Taiwan - MTW' , 0 , 0 , 0 ] , ['China - MTBC' , 0 , 0 , 0 ]];
	
	var currParentPtr = 0;
	
	geo_sites[ 0 ] = [ 'Beit Mellanox', 32.666081 , 35.106154 , 1 , "flag_israel.png"]; //verified
	geo_sites[ 1 ] = [ 'Ez Chip',32.661275, 35.105712, 1 , "flag_israel.png"];  //verified
	geo_sites[ 2 ] = [ 'Hermon Bldg.', 32.637178, 35.090629, 1 , "flag_israel.png"]; //according to hermon str
	geo_sites[ 3 ] = [ 'Tavor Bldg.', 32.644889, 35.095888 , 1 , "flag_israel.png"]; //according to tavor str
	geo_sites[ 4 ] = [ 'Levinstein Bldg.', 32.671281 , 35.107057 , 1 , "flag_israel.pngs"]; //verified 
	geo_sites[ 5 ] = [ 'Tel-Aviv - MTV', 32.107235, 34.836098  , null , "flag_israel.png"]; //verified
	geo_sites[ 6 ] = [ 'Raanana - MTR', 32.198310, 34.882461  , null , "flag_israel.png"]; //verified
	geo_sites[ 7 ] = [ 'Ramat-Gan - MTG', 32.090590, 34.870558  , null , "flag_israel.png" ]; //verified
	geo_sites[ 8 ] = [ 'Beer Sheva BLDG 1',31.263484, 34.811114  , 2  , "flag_israel.png"]; //verified
	geo_sites[ 9 ] = [ 'Beer Sheva BLDG 2',null , null  , 2 , "flag_israel.png"]; //no street found
	geo_sites[ 10 ] = [ 'Ez Chip Kiryat Gat' ,null , null , null  , "flag_israel.png"]; //no street found
	geo_sites[ 11 ] = [ 'Tel-Hai - MTH', 33.236037, 35.583220 , null , "flag_israel.png"];
	geo_sites[ 12 ] = [ 'Sunnyvale - MTI', 37.3788315, -121.98881 , null , "usa-flag.png"  ];
	geo_sites[ 13 ] = [ 'Austin',  30.3978941,-97.7297516  ,4 , null , "usa-flag.png" ];
	geo_sites[ 14 ] = [ 'Houston', null ,null , 4 ,  "usa-flag.png" ];
	geo_sites[ 15 ] = [ 'Redmond - MTS', 47.6808206 ,-122.1324999 ,  null , "usa-flag.png" ];
	geo_sites[ 16 ] = [ 'LA', null , null , 5 ,  "usa-flag.png" ];
	geo_sites[ 17 ] = [ 'Monterey Park Site', 34.0462349,-118.1628729 , 5 , null , "usa-flag.png" ];
	geo_sites[ 18 ] = [ 'New York - MTNY' , 40.7095563,-74.0087531 , null, "usa-flag.png"];
	geo_sites[ 19 ] = [ 'North Carolina - MTNC' , 35.8804253,-78.8399453 , null, "usa-flag.png"];
	geo_sites[ 20 ] = [ 'Massachusetts', null , null ,3 , "usa-flag.png" ];
	geo_sites[ 21 ] = [ 'Ez chip Boston', null , null ,3 , "usa-flag.png" ];
	
	//geo_sites[ 22 ] = [ 'Taiwan Site',25.0742254,121.5763775];
	geo_sites[ 22 ] = [ 'Taipei', 5.0742254 ,121.5763775  , 6 , "Taiwan-flag.png"];
	geo_sites[ 23 ] = [ 'ASE', null , null  , 6  , "Taiwan-flag.png"];
	geo_sites[ 24 ] = [ 'Beijing Viva Plaza Bldg.',39.9740321,116.3046697  , 7 , "china_flag.png"];
	geo_sites[ 25 ] = [ 'Beijing Poly Bldg.',null , null  , 7 , "china_flag.png"];
	geo_sites[ 26 ] = [ 'Shenzhen' , null , null   , 7  , "china_flag.png"];
	geo_sites[ 27 ] = [ 'Tokyo - MTTK',35.6904433,139.6978957 , null , "flag_japan.png"];
	geo_sites[ 28 ] = [ 'Korea', null , null , null , "korea_flag.png"];
	geo_sites[ 29 ] = [ 'Denmark - MTDK',55.623264,12.0578227 ,null ,  "denmark_flag.png"  ];
	geo_sites[ 30 ] = [ 'UK - MTUK', null , null  ,null ,  "uk-flag.jpeg"  ];
	geo_sites[ 31] = [ 'Netherlands - MTNL', null ,null ,null ,  "netherlands_flag.png"  ];
	
	
	nv_apps[ 0 ] = [ 'Waze<BR>App', '#B1E4E3', '#81B4C3', '#ffffff' ];
	nv_apps[ 1 ] = [ 'Google<BR>Maps', '#A6FFE1', '#17A662', '#BA0000' ];
	nv_apps[ 2 ] = [ 'Apple<BR>Maps', '#e9F1FD', '#D9D1BD', '#3298FF' ];
	

function navigate( event , nv_selected){


	
	if ( navigator.userAgent.indexOf("iPhone") > 0 || navigator.userAgent.indexOf("iPad") > 0 || navigator.userAgent.indexOf("iPod") > 0) {
		var cookie = getCookie("iosNavigationChoosen");
		console.log("cookie = " + cookie);
		if (!cookie) {
			showView(event);
		}
		else {
			onNavigateApp(event , cookie);
		}

	}
	 else if (navigator.userAgent.indexOf("Android") > 0  ) {
		onNavigateApp(event , nv_selected);
	}
	else {
		showView(event);
	}
}


function onNavigateApp(event , mode ) {
	
	if ( navigator.userAgent.indexOf("iPhone") > 0 || navigator.userAgent.indexOf("iPad") > 0 || navigator.userAgent.indexOf("iPod") > 0) {
		createCookie("iosNavigationChoosen" , mode , 90);
		console.log("cookie is saved");
	
	}
	if (isNavButtonClicked == true) {
		
		//closeCustomView(event);
		console.log("it just a navbutton!");
		isNavButtonClicked = false;
	}
	else {
		console.log("it is click on city!");
		var i = event.target.tag;
		var dkm;
		dkm= geo_sites[ i ] [ 10 ] ;
		console.log("in navigate func");
		console.log("mode = " + mode);
	
		if ( dkm >1000) {
			console.log("case dkm > 1000");
			mode = 1;
		}
		if ( mode == 3 ) {
			setTimeout (function () {
				alert("Ooops... no waze installed :(");
				}, 1000);
			console.log("case nv_selected ==0");
			window.location = "waze://?ll=" + geo_sites[i][1] +  "," + geo_sites[i][2] +  "&navigate=yes";
			console.log("location = " + location); 
				
					
			
		}
		else if ( mode == 1 )  {
			console.log("case nv_selected == 1");
			window.open("http://maps.google.com/?q=Mellanox&ll=" + geo_sites[i][1] +  "," + geo_sites[i][2] +  "&z=17&navigate=yes" , '_blank') ;
		}
		else if ( mode == 2 ) {
			console.log("case nv_selected == 2");
			window.open("http://maps.apple.com/?q=Mellanox&ll=" + geo_sites[i][1] +  "," + geo_sites[i][2] +  "&z=17&navigate=yes" , '_blank');
		}
	}
}



function btnSelected(id) {
		for (var i in [1,2,3]){
			document.getElementById('nv_but_'+i).style.borderColor="#34495e";
			document.getElementById('nv_but_'+i).style.backgroundColor="#34495e";
		}

		document.getElementById(id).style.borderColor="#3498db";
		document.getElementById(id).style.backgroundColor="rgba(32, 77, 116, 0.77)";

		// nv_but_" + i +

	}
function showPosition(position) {
	console.log("in show position func");
	detected = 1;
	nv_lat = position.coords.latitude; 
	nv_lon = position.coords.longitude; 
	console.log("nv_lat = " + nv_lat);
	console.log("nv_lon = " + nv_lon);
	nv_sites_draw();
}


function showPositionYokneam() {
	console.log("in showPositionYokneam");
	detected = 1;
	nv_lat = 32.6634631 ;
	nv_lon = 35.1053271; 
	
	nv_sites_draw();

}

function closeCustomView (event) {
	
	var target = event.target;
	
	var newElement = document.getElementById("newElement");
	function move() {

		var cBottomStr = newElement.style.bottom;
	
		var cBottom = parseInt( cBottomStr.substr(0, cBottomStr.length - 2) , 10);
	
	
		
		
			if (cBottom > -320) {
				cBottom -= 10;
				newElement.style.bottom = cBottom + "px";
				setTimeout (move, 8);
			}
			else {
				document.getElementById("touchElement").remove();
			}
		
	
		
	}
	
	
	console.log("in closeCustomView func");
	console.log ("target.id = " + target.id);
	
	if (target.id == "touchElement" || target.id == "cancelDiv" || target.id == "cancelP" ) {
	
		//target.remove();
		var eventPhase = event.eventPhase;
		console.log("onTouchElementClick , eventPhase = " + eventPhase); 
		move();
	}
	else if (target.id == "appleDiv" || target.id == "appleP") {
		onNavigateApp(event, 2);
		move();
	}
	
	else if (target.id == "googleDiv" || target.id == "googleP") {
		onNavigateApp(event, 1);
		move();
	}
	else if (target.id == "wazeDiv" || target.id == "wazeP"){
		onNavigateApp(event, 3);
		move();
	
	}
	

}


var createCookie = function(name, value, days) {
    var expires;
    if (days) {
        var date = new Date();
        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
        expires = "; expires=" + date.toGMTString();
    }
    else {
        expires = "";
    }
    var str =  name + "=" + value + expires + "; path=/";
    console.log("str = " + str);
    document.cookie = name + "=" + value + expires + "; path=/";
    console.log("document.cookie = " + document.cookie);
}



function getCookie(c_name) {
    if (document.cookie.length > 0) {
        c_start = document.cookie.indexOf(c_name + "=");
        if (c_start != -1) {
            c_start = c_start + c_name.length + 1;
            c_end = document.cookie.indexOf(";", c_start);
            if (c_end == -1) {
                c_end = document.cookie.length;
            }
            return unescape(document.cookie.substring(c_start, c_end));
        }
    }
    return "";
}


function showView(event) {

	var tag = event.target.tag;
	var touchElement = document.createElement('div');
	touchElement.style.width = "100%";
	touchElement.style.height = "100vh";
	touchElement.style.bottom = "0";
	touchElement.id = "touchElement";
	
	touchElement.style.backgroundColor = "rgba( 0 , 0 , 0 , 0.3)";
	touchElement.style.position = 'fixed';
	if (touchElement.addEventListener) {
				console.log("added eventListener to touchElement");
                touchElement.addEventListener("click", closeCustomView, false);
            } else {
            	console.log("attached event to touchElement");
                touchElement.attachEvent('onclick', closeCustomView);
            }
	
	document.body.appendChild(touchElement);
	touchElement.style.zIndex =  '1000';
	
	
	var newElement =  document.createElement('div');
	newElement.style.textAlign = "center"; 

	newElement.style.width = "100%";
	newElement.style.height = '320px';
	newElement.style.bottom = "-320px";
	newElement.style.position = 'absolute';
	newElement.style.backgroundColor = 'transparent';
	newElement.style.paddingLeft = '20px';
	newElement.style.paddingRight = '20px';
	newElement.id = "newElement";
	newElement.style.display = 'block';
	newElement.style.textAlign = 'center';
	touchElement.appendChild(newElement);
	
	var chooseDiv = document.createElement('div');
	chooseDiv.style.height = '220px';
	//chooseDiv.style.marginTop = "20px";
	chooseDiv.style.width = '95%';
	chooseDiv.style.overflow = "hidden";
	chooseDiv.style.backgroundColor = "transparent";

	var cornerRadius = '10px';
	
	chooseDiv.style.display = "inline-block";
	newElement.appendChild(chooseDiv);
	
	
	var appleDiv = document.createElement('div');
	appleDiv.style.width = '100%';
	appleDiv.style["-moz-border-radius"] = "10px 10px 0 0";
	appleDiv.style["-webkit-border-radius"] = "10px 10px 0 0";
	appleDiv.style["-ms-border-radius"] = "10px 10px 0 0";
	appleDiv.style["-o-border-radius"] = "10px 10px 0 0";
	appleDiv.style["-khtml-border-radius"] = "10px 10px 0 0";
	appleDiv.style["border-radius"] = "10px 10px 0 0";
	appleDiv.style.display = 'block';
	appleDiv.style.height = "70px";
	appleDiv.style.flex = '1';
	appleDiv.style['-webkit-flex'] = '1';
	appleDiv.style.backgroundColor = "#fff";
	appleDiv.style.borderWidth = "1px";
	appleDiv.tag = event.target.tag;
	appleDiv.style.borderColor = "#ccc";
	appleDiv.style.borderStyle = "solid";
	appleDiv.id = "appleDiv";
	appleDiv.tag = tag;
    chooseDiv.appendChild(appleDiv);
    
    
    var appleP = document.createElement('p');
    appleP.innerHTML = "Open in Apple Maps";
    appleP.style.color = 'rgba(10 , 128 , 251 , 1)';
    appleP.style.fontFamily = "'Open Sans', 'Helvetica Neue', 'Helvetica', 'Arial', 'sans-serif'";
	appleP.style.fontSize = '18px';
	appleP.style.lineHeight = "70px";
	appleP.tag = tag;
	appleP.id = "appleP";
	appleDiv.appendChild(appleP);
    
    
	
	var googleDiv = document.createElement('div');
	googleDiv.style.width = '100%';
	googleDiv.style.display = 'block';
	googleDiv.style.flex = '1';
	googleDiv.style['-webkit-flex'] = '1';
	googleDiv.style.backgroundColor = "#fff";
	googleDiv.style.borderWidth = "1px";
	googleDiv.style.borderColor = "#ccc";
	googleDiv.style.borderStyle = "solid";
	googleDiv.style.height = "70px";
	googleDiv.id = "googleDiv";
	googleDiv.tag = tag;
    
    
	chooseDiv.appendChild(googleDiv);
	
	var googleP = document.createElement('p');
    googleP.innerHTML = "Open in Google Maps";
    googleP.style.color = 'rgba(10 , 128 , 251 , 1)';
    googleP.style.fontFamily = "'Open Sans', 'Helvetica Neue', 'Helvetica', 'Arial', 'sans-serif'";
	googleP.style.fontSize = '18px';
	googleP.id = "googleP";
	googleP.style.lineHeight = "70px";
	googleP.tag = tag;
	googleDiv.appendChild(googleP);
    
    
    var wazeDiv = document.createElement('div');
	wazeDiv.style.width = '100%';
	wazeDiv.style.display = 'block';
	wazeDiv.style.flex = '1';
	wazeDiv.style['-webkit-flex'] = '1';
	wazeDiv.style.backgroundColor = "#fff";
	wazeDiv.tag = tag;
	wazeDiv.style.height = "70px";
	
    wazeDiv.style["-moz-border-radius"] = "0 0 10px 10px";
	wazeDiv.style["-webkit-border-radius"] = "0 0 10px 10px";
	wazeDiv.style["-ms-border-radius"] = "0 0 10px 10px";
	wazeDiv.style["-o-border-radius"] = "0 0 10px 10px";
	wazeDiv.style["-khtml-border-radius"] = "0 0 10px 10px";
	wazeDiv.style["border-radius"] = "0 0 10px 10px";
	wazeDiv.style.borderWidth = "1px";
	wazeDiv.style.borderColor = "#ccc";
	wazeDiv.style.borderStyle = "solid";
	wazeDiv.id = "wazeDiv";
    chooseDiv.appendChild(wazeDiv);
    
    var wazeP = document.createElement('p');
    wazeP.innerHTML = "Open in Waze";
    wazeP.style.color = 'rgba(10 , 128 , 251 , 1)';
    wazeP.style.fontFamily = "'Open Sans', 'Helvetica Neue', 'Helvetica', 'Arial', 'sans-serif'";
	wazeP.style.fontSize = '18px';
	wazeP.id = "wazeP";
	wazeP.style.lineHeight = "70px";
	wazeP.tag = tag;
	wazeDiv.appendChild(wazeP);
    

	/*
    var cancelWrapper= document.createElement('div');
    cancelWrapper.style.backgroundColor = "#00ff00";
    cancelWrapper.style.height = "70px";
    cancelWrapper.style.width = '95%';
	cancelWrapper.style.overflow = "hidden";
	cancelWrapper.style.display = "inline-block";
	newElement.appendChild(cancelWrapper);
	//chooseDiv.style.backgroundColor = "transparent";
  	*/
    
    var cancelDiv = document.createElement('div');
	cancelDiv.style.width = '95%';
	cancelDiv.style["-moz-border-radius"] = "10px 10px 10px 10px";
	cancelDiv.style["-webkit-border-radius"] = "10px 10px 10px 10px";
	cancelDiv.style["-ms-border-radius"] = "10px 10px 10px 10px";
	cancelDiv.style["-o-border-radius"] = "10px 10px 10px 10px";
	cancelDiv.style["-khtml-border-radius"] ="10px 10px 10px 10px";
	cancelDiv.style["border-radius"] = "10px 10px 10px 10px";
	cancelDiv.style.height = "70px";
	//cancelDiv.style.position = 'absolute';
	cancelDiv.style.bottom = "20px";
	cancelDiv.style.backgroundColor = "#fff";
	cancelDiv.style.textAlign = "center";
	cancelDiv.style.borderWidth = "2px";
	cancelDiv.style.borderColor = "#ccc";
	cancelDiv.style.borderStyle = "solid";
    cancelDiv.style.strokeWidth = '1px';
    cancelDiv.style.display = "inline-block";
    cancelDiv.style.verticalAlign = "middle";
    cancelDiv.tag = 3;
    cancelDiv.id = "cancelDiv";
    newElement.appendChild(cancelDiv);
    
    
    
    var cancelP = document.createElement('p');
    cancelP.innerHTML = "Cancel";
    cancelP.style.color = 'rgba(10 , 128 , 251 , 1)';
    cancelP.style.fontFamily = "'Open Sans', 'Helvetica Neue', 'Helvetica', 'Arial', 'sans-serif'";
	cancelP.style.fontSize = '18px';
	cancelP.style.width = '100%';
	cancelP.id = "cancelP";
	//cancelP.style.display = "table-cell";
	cancelP.style.verticalAlign = 'middle';
	cancelP.style.lineHeight = '70px';
	cancelDiv.appendChild(cancelP);
	
	
    function move() {

    var cBottomStr = newElement.style.bottom;
   
    var cBottom = parseInt( cBottomStr.substr(0, cBottomStr.length - 2) , 10);
	
		
		
		if (cBottom < 0) {
			cBottom += 10;
			newElement.style.bottom = cBottom + "px";
			setTimeout (move, 8);
		}
		
	
		
	}
	
	
	move();
  
    
    
       //-moz-transition: left .2s;
         //-o-transition: left .2s;
           // transition: left .2s;

	/*
	var innerDiv = document.createElement('div');
	innerDiv.style.backgroundColor = '#cedd05';
	innerDiv.style.width = '100%';
	innerDiv.style.height = '100%';
	innerDiv.style.bottom = "0";
	innerDiv.style.position = 'absolute';
	innerDiv.style.textAlign = 'left';
	innerDiv.style.paddingTop = "10px";
	newElement.appendChild(innerDiv);
	
	var title = document.createElement('p');
	title.innerHTML = '<strong>Open with</strong>';
	title.style.color = '#000000';
	title.style.fontFamily = "'Open Sans', 'Helvetica Neue', 'Helvetica', 'Arial', 'sans-serif'";
	title.style.fontSize = '21px';
	innerDiv.appendChild(title);
	
	var iconsDiv = document.createElement('div');
	iconsDiv.style.backgroundColor = '#6587F5';
	iconsDiv.style.marginTop = '10px';
	iconsDiv.style.height = '140px';
	iconsDiv.style.width = '100%';
	iconsDiv.style.display = 'flex';
	innerDiv.appendChild(iconsDiv);
	
	
	
	var wazeDiv = document.createElement('div');
	wazeDiv.style.backgroundColor = '#CCCCCC';
	wazeDiv.style.height = '100%';
	wazeDiv.style.display = 'block';
	wazeDiv.style.flex = '1';
	wazeDiv.style['-webkit-flex'] = '1';
	wazeDiv.style.textAlign = 'center';
	wazeDiv.style.paddingTop = '25px';
	iconsDiv.appendChild(wazeDiv);
	
	
	var wazeImg = document.createElement('img');
	wazeImg.src = "images/waze.jpeg";
	wazeImg.style.width = '50px';
	wazeImg.style.height = '50px';
	wazeDiv.appendChild(wazeImg);
	
	var wazeLabel = document.createElement('p');
	wazeLabel.innerHTML = "Waze";
	wazeLabel.style.color = '#000000';
	wazeLabel.style.paddingTop = '20px';
	wazeLabel.style.fontFamily = "'Open Sans', 'Helvetica Neue', 'Helvetica', 'Arial', 'sans-serif'";
	wazeLabel.style.fontSize = '16px';
	wazeDiv.appendChild(wazeLabel);
	
	
	
	var appleDiv = document.createElement('div');
	appleDiv.style.backgroundColor = '#AAAAAA';
	appleDiv.style.height = '100%';
	appleDiv.style.display = 'flex';
	appleDiv.style.display = 'block';
	appleDiv.style.textAlign = 'center';
	appleDiv.style.paddingTop = '25px';
	appleDiv.style.flex = '1';
	appleDiv.style['-webkit-flex'] = '1';
	iconsDiv.appendChild(appleDiv);
	
	var appleImg = document.createElement('img');
	appleImg.src = "images/apple-maps.png";
	appleImg.style.width = '50px';
	appleImg.style.height = '50px';
	appleDiv.appendChild(appleImg);
	
	var appleLabel = document.createElement('p');
	appleLabel.innerHTML = "Apple Maps";
	appleLabel.style.color = '#000000';
	appleLabel.style.paddingTop = '20px';
	appleLabel.style.fontFamily = "'Open Sans', 'Helvetica Neue', 'Helvetica', 'Arial', 'sans-serif'";
	appleLabel.style.fontSize = '16px';
	appleDiv.appendChild(appleLabel);
	
	
	var googleDiv = document.createElement('div');
	googleDiv.style.backgroundColor = '#999999';
	googleDiv.style.flex = '1';
	googleDiv.style['-webkit-flex'] = '1';
	googleDiv.style.display = 'block';
	googleDiv.style.textAlign = 'center';
	googleDiv.style.paddingTop = '25px';
	googleDiv.style.height = '100%';
	iconsDiv.appendChild(googleDiv);
	
	var googleImg = document.createElement('img');
	googleImg.src = "images/google-maps.png";
	googleImg.style.width = '50px';
	googleImg.style.height = '50px';
	googleDiv.appendChild(googleImg);
	
	
	var googleLabel = document.createElement('p');
	googleLabel.innerHTML = "Google Maps";
	googleLabel.style.color = '#000000';
	googleLabel.style.paddingTop = '20px';
	googleLabel.style.fontFamily = "'Open Sans', 'Helvetica Neue', 'Helvetica', 'Arial', 'sans-serif'";
	googleLabel.style.fontSize = '16px';
	googleDiv.appendChild(googleLabel);
	
	
	var buttonsDiv = document.createElement('div');
	buttonsDiv.style.backgroundColor = '#ffa3a3';
	buttonsDiv.style.marginTop = '10px';
	//buttonsDiv.style.bottom = '0';
	buttonsDivhttp://www.color-hex.com/.style.height = '40px';
	buttonsDiv.style.width = '100%';
	buttonsDiv.style.display = 'flex';
	innerDiv.appendChild(buttonsDiv);
	
	var emptyDiv = document.createElement('div');
	emptyDiv.style.height = '100%';
	emptyDiv.style.display = 'block';
	emptyDiv.style.backgroundColor = '#F5F5DC';
	emptyDiv.style.textAlign = 'center';
	emptyDiv.style.flex = '1';
	emptyDiv.style['-webkit-flex'] = '1';
	buttonsDiv.appendChild(emptyDiv);
	
	var onceDiv = document.createElement('div');
	onceDiv.style.height = '100%';
	onceDiv.style.display = 'block';
	onceDiv.style.backgroundColor = '#b09e8b';
	onceDiv.style.textAlign = 'center';
	onceDiv.style.flex = '1';
	onceDiv.style['-webkit-flex'] = '1';
	buttonsDiv.appendChild(onceDiv);
	
	
	var alwaysDiv = document.createElement('div');
	alwaysDiv.style.height = '100%';
	alwaysDiv.style.display = 'block';
	alwaysDiv.style.backgroundColor = '#d0d69f';
	alwaysDiv.style.textAlign = 'center';
	alwaysDiv.style.flex = '1';
	alwaysDiv.style['-webkit-flex'] = '1';
	buttonsDiv.appendChild(alwaysDiv);
	
	*/
	
	
	console.log("we are here");

}



function nv_sites_draw(){
	var min_site = '';
	var min_distance = 10000000000;

	document.getElementById( "geo_buttons").innerHTML = '';

	//distance till location define
	for( var i=0 ; i < geo_sites.length; i ++ ){


		if ( detected ) {

			var lat1 = nv_lat;
			var lon1 = nv_lon;
		
			var lat2 = geo_sites[i][1];
			var lon2 = geo_sites[i][2];


			var R = 6371000; // metres
			var f1 = lat1 * Math.PI / 180;
			var f2 = lat2 * Math.PI / 180;
			var df = (lat2-lat1) * Math.PI / 180;
			var dg = (lon2-lon1) * Math.PI / 180;

			var a = Math.sin(df/2) * Math.sin(df/2) +
					Math.cos(f1) * Math.cos(f2) *
					Math.sin(dg/2) * Math.sin(dg/2);
			var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
		
			var d = R * c;
		
			geo_sites[ i ][ 10 ] = d;
	
			if ( min_distance > d ) {
				min_distance = d;
				min_site = geo_sites[ i ][0];
			}	
		
			dkm = Math.round( d * 0.001 ) ;
			console.log("dkm calculed , dkm = " + dkm)
		
			
		} else  {
	
			dkm = 0;
		}
		
		geo_sites[ i ][ 10 ] = dkm;
		
	}
	
	//array sort
	for( var k=0 ; k < geo_sites.length; k ++ ) {
		for( var i=0 ; i < geo_sites.length-1; i ++ ){
		
			if ( geo_sites[i][10] > geo_sites[i+1][10] ){
			
				var a = new Array();
				a = geo_sites[i+1];
				geo_sites[i+1] = geo_sites[i];
				geo_sites[i] = a;
			}
		}
	}
	
	for( var i=0 ; i < geo_sites.length; i ++ ){
	
		dkm = geo_sites[ i ] [ 10 ] ;
		var parent = geo_sites[i][3];
		console.log("parent = " + parent);
		var newElement =  document.createElement('div');
		newElement.style.paddingTop = '5px';
		if (!parent) {
			if ( dkm  ){
				console.log("no parent, dkm = " + dkm);
				var button = document.createElement('button');
				button.classList.add('btn');
				button.classList.add('btn-lg');
				button.classList.add('btn-info');
				button.classList.add('btn-block');
				button.tag = i;
				button.addEventListener("click" , navigate );
				button.innerHTML = geo_sites[i][0];
				if (dkm > 1000) {
					button.style.backgroundColor = 'rgba(218, 214, 217, 0.97)';
					button.style.borderColor = 'rgba(101, 97, 100, 0.97)';
					button.style.color = 'rgba(101, 97, 100, 0.97)';
					
		
				}
				var image = document.createElement('img');
				var name = geo_sites[ i ][4];
				console.log("name = " + name);
				image.src = "images/" + name;
				image.style.position = 'absolute';
				image.style['-webkit-border-radius'] = '10px';
				image.style['-moz-border-radius'] = '10px';
				image.style.borderRadius = '10px';
				image.style.height = "20px";
				image.style.width = "20px";
				button.appendChild(image);
				image.style.left = '30px';
				
				newElement.appendChild(button);
			}
			else  {
				console.log("no parent, dkm = 0, airplain "  );
				var button = document.createElement('button');
				button.classList.add('btn');
				button.classList.add('btn-lg');
				button.classList.add('btn-info');
				button.classList.add('btn-block');
				button.tag = i;
				button.addEventListener("click" , navigate );
				button.innerHTML = geo_sites[i][0];
				newElement.appendChild(button);
				
				var image = document.createElement('img');
				var name = geo_sites[ i ][4];
				
				image.src = "images/" + name;
				image.style.position = 'absolute';
				button.appendChild(image);
				image.style.left = '50px';
			}
			document.getElementById( "geo_buttons").appendChild(newElement);
		}
		else {
			if (parent!= currParentPtr && cities[parent][3] == 0 ) {
				cities[parent][3] = 1
				console.log("have parent, dkm = " + dkm)
				currParentPtr = parent; 
				
				var button = document.createElement('button');
				newElement.appendChild(button);
				document.getElementById( "geo_buttons").appendChild(newElement);
				button.classList.add('btn');
				button.classList.add('btn-lg');
				button.classList.add('btn-info');
				button.classList.add('btn-block');
				button.style.display = 'inline';
				button.id =  "city_" + currParentPtr;
				console.log("button_id = " + button.id);
				button.tag = currParentPtr;
				button.addEventListener ("click" , onCityClick);//  .click = onCityClick(currParentPtr);
				button.innerHTML = cities[currParentPtr][0];
				
				
			
				
				if (dkm > 1000) {
					button.style.backgroundColor = 'rgba(218, 214, 217, 0.97)';
					button.style.borderColor = 'rgba(101, 97, 100, 0.97)';
					button.style.color = 'rgba(101, 97, 100, 0.97)';
				
				
				}
				var image = document.createElement('img');
				var name = geo_sites[ i ][4];
				console.log("FlagName = " + name);
				image.src = "images/" + name;
				image.style.position = 'absolute';
				image.style['-webkit-border-radius'] = '10px';
				image.style['-moz-border-radius'] = '10px';
				image.style.borderRadius = '10px';
				image.style.height = "20px";
				image.style.width = "20px";
				button.appendChild(image);
				image.style.left = '30px';
				
				var imageDown = document.createElement('img');
				imageDown.src = "images/down.png";
				imageDown.style.height = '20px';
				imageDown.style.position = 'absolute';
				imageDown.id = "arrow_" + currParentPtr;
				imageDown.style.right = '30px';
				button.appendChild(imageDown);
				
		
				
				
				
			}
			else {
				console.log("have parent, same parent as prev ,  dkm =  " + dkm)
			}
		}
	}
}



function getGeoSitesForCityIndex (i) {
	var arr = new Array();
	var len = geo_sites.length;

	for (var k = 0 ; k < len ; k++ ) {
		if (geo_sites[k][3] == i) {
			geo_sites[k][5] = k;
			arr.push(geo_sites[k]);
		} 
	} 
	console.log("for city = " + i + " found " + arr.length + " geo_sites");
	return arr;
}



function onCityClick (event) {
	//console.log("onCityClick , aCityindex = " + aCityindex);

	var aCityindex = event.target.tag; 
	if (!aCityindex) {
		aCityindex = event.target.parentNode.tag;
	}
	//console.log("onCityClick , tag = " + tag);
	var cityElement = document.getElementById( "city_" + aCityindex );
	
	//console.log("cities[i][1] = " + cities[aCityindex][1]);
	
	
	var arrow =  document.getElementById("arrow_" + aCityindex);
	console.log("arrow obj = " + arrow);
	
	
	if (cities[aCityindex][1] == 0) {
   		arrow.style.webkitTransform = "rotate(-180deg)";
		var arr = getGeoSitesForCityIndex (aCityindex);
		var len = arr.length;
	
		var insertAfterElement = cityElement;
		
	
		for (var i = 0 ; i < len ; i++ ) { 
			
			
			var newElement =  document.createElement('div');
			newElement.style.textAlign = "center"; 
			//newElement.style.backgroundColor = 'rgba(100, 236, 0, 0.97)';
			//newElement.style.display = "inline";
			//newElement.style.width = "100%";
			
			//newElement.innerHTML =  "<button type=button onClick='navigate( "+ arr[i][4] + " )' class='btn btn-info btn-lg btn-block'>" + arr[i][0] + "</button>";
			newElement.style.paddingTop = '5px';
			
			//newElement.classList.add('div-subcity');
			var dkm = arr[i][10];
			
			var button = document.createElement('button');
			button.classList.add('btn');
			button.classList.add('btn-lg');
			button.classList.add('btn-info');
			button.classList.add('btn-block');
			button.style.backgroundColor = 'rgba(167 , 207, 239 , 0.97)';
			button.style.width = "90%";
			button.tag = arr[i][5];
			button.style.margin = "0 auto";
			button.addEventListener("click" , navigate );
			button.innerHTML = arr[i][0];
			if (dkm > 1000) {
				button.style.backgroundColor = 'rgba(236, 236, 236, 0.97)';
				button.style.borderColor = 'rgba(101, 97, 100, 0.97)';
				button.style.color = 'rgba(101, 97, 100, 0.97)';
				
			}
			
			
			
			newElement.appendChild(button);
			
			/*
			//if ( dkm > 1000 ){
					console.log("city clicked , dkm = " + dkm);
					newElement.innerHTML = "<button type=button onClick='navigate( "+ arr[i][5] + " )' class='btn btn-block-subcity  btn-lg '>" + arr[i][0] + "</button>";
			}
			else  {
					console.log("city clicked , dkm = 0" );
					newElement.innerHTML = "<button type=button onClick='navigate( "+ arr[i][5] + " )' class='btn btn-block-subcity  btn-lg '>" + arr[i][0] + "</button>";
			}
			*/
		
			

			cityElement.parentNode.insertBefore(newElement, insertAfterElement.nextSibling);
			insertAfterElement = newElement;
		}
		
		console.log("aCityindex = " + aCityindex);
		
		cities[aCityindex][1] = arr.length;
		
	}
	
	else {
		arrow.style.webkitTransform = "rotate(0deg)";
		for (var i = 0 ; i < cities[aCityindex][1] ; i++ ) {
			cityElement.nextElementSibling.remove();
		}
		cities[aCityindex][1]  = 0 ;
	
	}
		

}


function createAppChooseView () {
	var newElement =  document.createElement('div');
	newElement.style.textAlign = "center"; 
}


	
function nv_apps_draw(){

	

	if ( navigator.userAgent.indexOf("iPhone") > 0 || navigator.userAgent.indexOf("iPad") > 0 || navigator.userAgent.indexOf("iPod") > 0) {
		console.log("IPHONE DETECTED")
		var cookie = getCookie("iosNavigationChoosen");
		
		console.log("cookie in nv_apps_draw = " + cookie);
		if (cookie == null) {
			alert("cookie in nv_apps_draw = NULL");
		}
		else if  (cookie == 0 ) {
			alert("cookie in nv_apps_draw = 0");
		}
		else {
			
			var nbutton = document.createElement("div");
			nbutton.style.height = '24px';
			nbutton.style.textAlign = 'center';
			nbutton.style.backgroundColor = 'rgba(219, 215 , 218, 1)';
			//nbutton.style.display="inline-block";
			nbutton.style.color = 'rgba(107 , 104 , 106 , 1)';
			nbutton.style.width = '100px';
			nbutton.style.verticalAlign = 'middle';
			nbutton.id = "navbutton";
			nbutton.style.position = 'absolute';
			nbutton.style.top = "25px";
			nbutton.style.right = '30px';
			nbutton.innerHTML = 'Navigate With';
			document.body.appendChild(nbutton);
			nbutton.style.zIndex =  '1000';
			nbutton.style.fontFamily = "'Open Sans', 'Helvetica Neue', 'Helvetica', 'Arial', 'sans-serif'";
			nbutton.style.fontSize = '14px';
			nbutton.style["-moz-border-radius"] = "3px";
			nbutton.style["-webkit-border-radius"] = "3px";
			nbutton.style["-ms-border-radius"] = "3px";
			nbutton.style["-o-border-radius"] = "3px";
			nbutton.style["-khtml-border-radius"] ="3px";
			nbutton.style["border-radius"] = "3px";
			nbutton.addEventListener("click", onNavButtonClick, false);
		}
		
		
	} else if (navigator.userAgent.indexOf("Android") > 0  ) {
		console.log("ANDROID DETECTED")
		document.getElementById('div_nav_buttons_label').style.display = 'none';
		document.getElementById('p_choose_your_dest_label').style.padding = 0;
	}
	else {
		console.log("WEB SITE DETECTED");
		showPositionYokneam();
	}
	
	
	
}

function onNavButtonClick(event) {

	isNavButtonClicked = true;
	console.log("isNavButtonIsSet to true");
	showView(event);
}


function nv_select( i ){
	//document.getElementById( "nv_but_" + nv_selected).style.backgroundColor = nv_apps[ nv_selected][1];
	//document.getElementById( "nv_but_" + nv_selected).style.fontWeight = '';
	nv_selected = i;
	//document.getElementById( "nv_but_" + i).style.backgroundColor = nv_apps[ nv_selected][2];
	//document.getElementById( "nv_but_" + i).style.fontWeight = 'bold';

}

function onLoad() {
	console.log("in OnLoad");
	nv_apps_draw();
	//nv_sites_draw(); 
	if (navigator.geolocation) { 
		navigator.geolocation.getCurrentPosition(showPosition)
	}
	else {
	}
	/*
	else {
		console.log("navigator.geolocation not detected"); 
		showPositionYokneam();
	}
	*/
}    

</script>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="white">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Drive To</title>

	<!-- Bootstrap -->
	<link rel="stylesheet" href="./Drive To_files/bootstrap.min.css">

	<!-- Vendor styles-->
	<link rel="stylesheet" href="./Drive To_files/font-awesome.css">
	<link rel="stylesheet" href="./Drive To_files/metisMenu.css">
	<link rel="stylesheet" href="./Drive To_files/animate.css">
	<link rel="stylesheet" href="./Drive To_files/bootstrap.css">

	<!-- App styles-->
	<link rel="stylesheet" href="./Drive To_files/pe-icon-7-stroke.css">
	<link rel="stylesheet" href="./Drive To_files/helper.css">
	<link rel="stylesheet" href="./Drive To_files/style.css">
	
</head>
  
<body style="background-color: #eee;" onload= "javascript:onLoad()">


<div class="col-xs-12 col-sm-12 col-md-3 col-lg-12" style="padding:10px; " >
  <div class="hpanel hblue">
	  <div class="panel-heading hbuilt text-center" id="panel">
		  <h4 class="font-bold">Drive To Site</h4>
	  </div>
	  <div class="panel-body" id="panel-body" style='display:block;'>
	  	
		  <p class="text-muted text-center" id="div_nav_buttons_label" style="display: none;">
			  Choose your preferred navigation App
		  </p>
		
		  <div data-toggle="buttons" align="center" style="width:100%;" id="geo_apps" style="margin-bottom:15;">
		  </div>
		  <!--
		  <p class="text-muted text-center" style="padding: 0px;" id="p_choose_your_dest_label">
			  Choose your destination site
		  </p>
		  -->
		
		  <div id="geo_buttons" stsle="margin:15;">
		  	
		  </div>
	  </div>
  </div>
</div>


</body></html>